name: Publish on Release

on:
  release:
    types: [published]

permissions:
  contents: write
  packages: write

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: main
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0

      - name: Publish NPM Package
        uses: phucbm/publish-npm-action@v1
        with:
          npm-token: ${{ secrets.NPM_TOKEN }}
          # github-token: ${{ secrets.CUSTOM_TOKEN }}        # Custom GitHub token, default is ${{ github.token }}
          # node-version: '20'                               # Node.js version, default is '18'
          # pnpm-version: '9'                                # PNPM version, default is '8'
          # build-command: 'npm run build:prod'              # Build command, default is 'pnpm build'
          # install-command: 'npm ci'                        # Install command, default is 'pnpm install --no-frozen-lockfile'
          # test-command: 'npm run test:ci'                  # Test command, default is 'pnpm test'
          # publish-access: 'restricted'                     # NPM access level, default is 'public'
          # skip-tests: 'true'                               # Skip tests, default is 'false'
          # output-dir: 'build/'                             # Output directory, default is 'dist/'
          # target-branch: 'develop'                         # Target branch, default is 'main'
          # commit-files: 'CHANGELOG.md docs/ types/'        # Additional files to commit, default is ''
